#!/usr/bin/env python3
# encode UTF-8

import pwn
import chatonCTF


c = 62324783949134119159408816513334912534343517300880137691662780895409992760262021
n = 1280678415822214057864524798453297819181910621573945477544758171055968245116423923
e = 65537
p = 1899107986527483535344517113948531328331
q = 674357869540600933870145899564746495319033


d = chatonCTF.rsaFindDfromPQ(p, q, e)

m = chatonCTF.rsaUncipherMessage(c, d, n)
pwn.info("Plaintext is {}".format(m))
hexstr = hex(m)[2:]
pwn.info("Decoded text is {}".format(str(hexstr)))
flag = pwn.unhex(hexstr)
pwn.success("Flag is {}".format(str(flag)))
pwn.success("Flag is copied to flag.txt")
pwn.write("flag.txt", flag)
